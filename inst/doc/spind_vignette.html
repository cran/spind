<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Sam Levin, Gudrun Carl, Ingolf Kuehn" />

<meta name="date" content="2018-01-04" />

<title>Intro to spind</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Intro to spind</h1>
<h4 class="author"><em>Sam Levin, Gudrun Carl, Ingolf Kuehn</em></h4>
<h4 class="date"><em>2018-01-04</em></h4>



<p><code>spind</code> is a package dedicated to removing the spectre of spatial autocorrelation in your spatial models. It contains many of the tools you need to make predictions, assess model performance, and conduct multimodel inference for 2-D gridded data sets using methods that are robust to spatial autocorrelation.</p>
<p>The theory underlying the use of GEEs, WRMs, and many of the other tools in this package is covered elsewhere in the literature, and for the purposes of this vignette, we assume that you have already read those papers. If you haven’t, citations are included in the footnotes of this vignette as well as in the documentation of each function. We also assume that you have a working knowledge of how to use <em>R</em>. This vignette will focus on demonstrating how to utilize this package to create a robust model from spatially referenced data and subsequently assess its accuracy. Along the way, we will use a couple different data sets to examine how these functions work and investigate how one might use them to create a spatially robust model. This particular demonstration will focus on species distribution models (hereafter referred to as SDMs), but this general framework can be applied to any data set that is spatially structured (e.g. economic, sociological).</p>
<div id="generalized-estimating-equations-gees-for-species-distribution-modeling-1" class="section level2">
<h2>Generalized Estimating Equations (GEEs) for species distribution modeling <a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a></h2>
<p>This package utilizes the functions already written for GEEs from the packages <code>gee</code><a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a> and <code>geepack</code><a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a> and adapts them for easy use in the context of an SDM. Let’s start with a fairly simple GEE using the simulated <code>musdata</code> data set included in the package. Before we get started though, note that <code>GEE</code> requires that <strong>predictor variables be continuous variables</strong>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(musdata)
<span class="kw">data</span>(carlinadata)

<span class="co"># Examine the structure to familiarize yourself with the data</span>
?musdata
<span class="kw">head</span>(musdata)

?carlinadata
<span class="kw">head</span>(carlinadata)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Next, fit a simple GEE and view the output</span>
coords &lt;-<span class="st"> </span>musdata[ ,<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]

mgee &lt;-<span class="st"> </span><span class="kw">GEE</span>(musculus <span class="op">~</span><span class="st"> </span>pollution <span class="op">+</span><span class="st"> </span>exposure, <span class="dt">family =</span> <span class="st">&quot;poisson&quot;</span>, <span class="dt">data =</span> musdata,
            <span class="dt">coord =</span> coords, <span class="dt">corstr =</span> <span class="st">&quot;fixed&quot;</span>, <span class="dt">plot =</span> <span class="ot">TRUE</span>, <span class="dt">scale.fix =</span> <span class="ot">FALSE</span>,
            <span class="dt">customize_plot =</span> <span class="kw">scale_color_manual</span>(<span class="st">&quot;Custom Legend&quot;</span>, <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">'green'</span>, <span class="st">'black'</span>)))
<span class="co">#&gt; Scale for 'colour' is already present. Adding another scale for</span>
<span class="co">#&gt; 'colour', which will replace the existing scale.</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">summary</span>(mgee, <span class="dt">printAutoCorPars =</span> <span class="ot">TRUE</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Call: </span>
<span class="co">#&gt; GEE(formula = musculus ~ pollution + exposure, family = &quot;poisson&quot;, </span>
<span class="co">#&gt;     data = musdata, coord = coords, corstr = &quot;fixed&quot;, plot = TRUE, </span>
<span class="co">#&gt;     scale.fix = FALSE, customize_plot = scale_color_manual(&quot;Custom Legend&quot;, </span>
<span class="co">#&gt;         values = c(&quot;green&quot;, &quot;black&quot;)))</span>
<span class="co">#&gt; --- </span>
<span class="co">#&gt;  Coefficients: </span>
<span class="co">#&gt;             Estimate  Std.Err z value  Pr(&gt;|z|)    </span>
<span class="co">#&gt; (Intercept) -1.90475  1.31091 -1.4530 0.1462252    </span>
<span class="co">#&gt; pollution    3.36216  0.91416  3.6779 0.0002352 ***</span>
<span class="co">#&gt; exposure    -1.46348  0.88010 -1.6629 0.0963410 .  </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; --- </span>
<span class="co">#&gt;  QIC:  1139.159 </span>
<span class="co">#&gt; --- </span>
<span class="co">#&gt; Autocorrelation of GLM residuals </span>
<span class="co">#&gt;  [1]  0.685338504  0.509680590  0.363021118  0.247398654  0.144726020</span>
<span class="co">#&gt;  [6]  0.084220961  0.050228656  0.022369044 -0.001985639 -0.027296083</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Autocorrelation of GEE residuals </span>
<span class="co">#&gt;  [1] -0.001277974 -0.004261554  0.045280260  0.022738750  0.005821352</span>
<span class="co">#&gt;  [6]  0.004289166  0.008311357  0.003437398  0.001030847 -0.010359040</span>
<span class="co">#&gt; --- </span>
<span class="co">#&gt;  Autocorrelation parameters from  fixed  model </span>
<span class="co">#&gt; [1] &quot;a=alpha^(d^v)  , alpha=0.685 , v=1.093&quot;</span>

predictions &lt;-<span class="st"> </span><span class="kw">predict</span>(mgee, <span class="dt">newdata =</span> musdata)</code></pre></div>
<p>As you can see, this package includes methods for <code>summary</code> and <code>predict</code>. These are useful in evaluating model fit and autocorrelation of residuals compared to a non-spatial model (in this case, a GLM with the same family as the GEE). Additionally, the <code>plot</code> argument in <code>GEE</code> can be used to visually inspect the autocorrelation of the residuals from each regression. Version 2.1.0 and up also has built in <code>ggplot2</code> style graphics which the user can customize using arguments passed to the <code>customize_plot</code> argument of the function. Note that a QIC (Quasi-information criterion) score is reported as opposed to AIC. This is calculated based on the method described in Hardin &amp; Hilbe<a href="#fn4" class="footnoteRef" id="fnref4"><sup>4</sup></a><sup>,</sup><a href="#fn5" class="footnoteRef" id="fnref5"><sup>5</sup></a> and is implemented using the function <code>qic.calc</code>.</p>
<p>Note that trying to fit GEEs with <code>corstr = &quot;fixed&quot;</code> to large data sets (i.e. number of observations is approximately <code>sqrt(.Machine$integer.max)</code>) will produce errors as the resulting variance-covariance matrices will be too large to be handled in <em>R</em> (you may well run into problems before this point depending on how much RAM you have available). This is where fitting clustered models can come in handy, as they work with smaller, more manageable matrices. These can be specified by changing the <code>corstr</code> to either <code>&quot;quadratic&quot;</code> or <code>&quot;exchangeable&quot;</code>.</p>
</div>
<div id="wavelet-revised-models-wrms-6" class="section level2">
<h2>Wavelet Revised Models (WRMs) <a href="#fn6" class="footnoteRef" id="fnref6"><sup>6</sup></a></h2>
<p>Next, we’ll examine the other main model that is introduced in this package - the Wavelet Revised Model. These are implemented using wavelet transforms from the <code>waveslim</code> package.<a href="#fn7" class="footnoteRef" id="fnref7"><sup>7</sup></a> Let’s start with a fairly simple WRM using the same <code>musdata</code> data set as above. As with <code>GEE</code>, <code>WRM</code> also requires that predictor variables are continuous.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">

mwrm &lt;-<span class="st"> </span><span class="kw">WRM</span>(musculus <span class="op">~</span><span class="st"> </span>pollution <span class="op">+</span><span class="st"> </span>exposure, <span class="dt">family =</span> <span class="st">&quot;poisson&quot;</span>,
            <span class="dt">data =</span> musdata, <span class="dt">coord =</span> coords, <span class="dt">level =</span> <span class="dv">1</span>, <span class="dt">plot =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAq4AAAHgCAMAAABTmx+1AAABFFBMVEUAAAAAADoAAGYAAP8AOmYAOpAAZrYzMzM6AAA6ADo6AGY6OmY6OpA6ZpA6ZrY6kJA6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmAGZmOgBmOjpmOpBmZjpmZmZmZrZmtv9uTU1uTW5uTY5ubo5ubqtuq8huq+SOTU2OTW6OTY6Obk2ObquOyP+QOgCQOjqQOmaQZgCQZpCQkGaQtpCQ27aQ2/+rbk2rbm6rbo6rjk2ryKur5OSr5P+2ZgC2Zjq2Zma2tma225C22/+2/9u2///Ijk3I///bkDrbkGbb/7bb/9vb///kq27k///y8vL/AAD/tmb/trb/yI7/25D/27b/29v/5Kv//7b//8j//9v//+T////BFi9IAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAXzElEQVR4nO2dC1vc2HmAwcTY67hbxsbObtoUr+NiO4GkjYs3F9h0W2C6MRQK7TCg//8/qqPLjKSRRudI5yq97/PYEkJHCOnlm09H57IRAQTDhusTAJAHXSEg0BUCAl0hINAVAgJdISD66YrsYBV0hYBAVwgIdIWAQFcICHSFgEBXCAh0hYBAVwgIdIWAQFcICHSFgEBXCAh0hYBoE27+frJ7KVYuJoKDeG329ly2NIBWWoR7+HwQXbzKv7oR5t5MXqIruKFFuPnH82U0nX84jqKzF38muoIjWoSbvbtMLRVkYTbT90kMuoJVWoQTH/+5rvmS3BVcoRBdb9JnLnQFZyjkrmf76TZ0BVe01gzs5ynrw/dZCouu4Aq5eldh6OKJC13BFbzVgoBAVwgIdIWA0K/r1dVVr2MCNKJd16srfAVT6Nb16gpfwRjoCgGBrhAQ5K4QEEZqBtAVzGCk3hVdwQxmdMVXMIKZt1r4CkYw9BIWXcEEpnTFVzCAqSYu6AoGMKYrvoJ+jDUgRFfQjzld8RW0Y655NrqCdgzqiq+gG4OdX9AVdGNSV3wFzZjsWoivoBmjPWHRFfRiVld8Ba2YHWcAXUErhnXFV9CJ4VFc0BV0YlpXfAWNmB4jC11BI8Z1xVfQh/ERCPEV9GF+wEx0BW1Y0BVfQRcWhiNGV9CFDV3xFTRhY7B3dAVNWNEVX0EPVqbSQFfQgx1d8RW0YGeiInQFLVjSFV9BB5amgcNX0IGtWQvRFTRgTVd8hf5YmxMWXaE/9nTFV+iNvRm30RV6Y1FXfIW+2NOV8Aq9sakrvkJPLOpKeIW+WNUVX6EfNnXFV+iJVV1JB6AflnXFV+iDXV0Jr9AL27riK/TAsq6EV+iDdV3xFbpjW1fCK/TAvq74Cp2xrivhFbrjQFd8ha7Y1xVfoTMOdCUdgK440RVfoRsudCW8Qkfc6Iqv0AknuhJeoRuOdMVX6EKbcPP3k93LZO1iMpm8PI9XHj4fyJZuBF2hCy3CCTUvXiWrZ7mkFxMNuuIrdKBFuPnH82j2Nomp3x+nm2a//k1/XfEVutAi3OzdZTT/IESNs4KJCKsP3/8lTQaexPTIfNEV1GkR7mY313X23XESYS/2deSuhFfognR0TTg7iDfo0ZXwCupI564JZweifmAy2ZcrvRbCKyjTWjOwn9UMiLTg4Y+6KrIE6AqqyNW7igAbx9UXSVagTVd8BUXcvNVKQVdQxKmu+ApquNSV8AqKuNUVX0EJp7riK6jhVlfSAVDCta5XBFiQxwNd8RVkcZ274isogK4QEOgKAUHuCgHhWFeqBkAF17pGvCsAeTzQFV9BFh905d0WSOKHrvgKUnihK76CHH7oSjoAUviiK76CBJ7oiq8ggy+6kg6ABCXh7l7v3b3eeHTarXQ/CK/QTkm4k+1o+uh0ut2tdE/wFVopChcH1/vD7ehaPrzq1JV0AFqp6Hr3esedrvgKLRSFuz/cud48EilBl9L9QVdooSTc7dON7ejk8ZdupXtDeIUWvKnIEuArrMcrXUkHYD0L4e5eb+Q4etSKCK/Qgl/RFV9hLZ7pSjoA66jWDLhNBgivsJZKvev94d7d671OpTWBr9BM5a1WdLITXctXvBrQlXQAmqnqOnXXZiCD8AqNVFtkxa5O3UZXfIVGSsLFyWt0srF51K20NtAVGvCtIktAeIUGfNQVX6GB8qOW65ewOegKtawKd/cL17kr4RUaqBHOcb1rAr5CHXW6uk8GSAeglhrhFLoTGNQVX2GVmkct5/WuCfgKq3hZkZWArrCCx7riK1Txq/NLCXyFKiXhpkJUx+1dC6ArVKg2IIw8qcgSEF6hgs+64itUqEsGdrqVNgC6QomycNfiSUs+dTWvK75CEX8rshLwFYp4rivpABQp1Lvu+dPedQnhFQr4Hl3xFQp4ryvpACzxZuaXRgivsMCfmV8aQVfI8WjmlyYIr5Dj0cwvjeArZPg080sj6AopPs380gjhFVL8r8gS4CskhKEr6QAklIWbbmzslcfLnL+f7F4mazeTycvzKJq9SRZ1pQ1CeAVBud718U9pXdaCh88H0cUrsTZ7ey7W5h+Oo4tMYIu64isIViqy9koVWfOP54moKfHa7N1lsnG1tGHQFVp1TeyMA2pKKbo+ibGpK75CpfOLSAZKnV9udpe6zt68OC4ms9XShsFXqOv8UuyqVY6u8drsu+Po5qWDZIB0AFqFK+eu0dlBMdza1hVfR0/5JexKr8KHz/tZzUDmqcPoiq9QM85AiTRVTWqxJhORu96ki9XSFri6wthxU3nUkm8usFraPFf4OnL8nEqjnqsrfB05gbQZSEDX0YOusBZRt9mYI94+O12uLb9Ycn+4sdNQotPWkHSN0NU6ybBpjU2gS7qu32HtfrVbr2uy0qB05VnLNukka6KGM+0iffvzbx/9GP87zb6MNbt9urGRdKD+Mf4i2/z8X9Kh1uIvN4+WJU9TMZMNt8+/RPe/O1oep8rJ5qfAo2sCvlpkOcfayY744vbpXiT+iS+n20IzIXSaCQjn8r12spLFbUktabZhuh2rGmv9ZXGcKHunWhhRcF0ykLVvUcONrvhqjeu8MendN6ci1Cbh9FmyKjZlQqVrwt3yXolxhW3ZhrTsNBZ1p3ycCoPQFV8tIj6y05VYnTggLnR9ncxolQh1Iqo+lwG2sNfiCSzblm7Iyz7/W5ILLI6z+sPXJQNT36bSaARfrbHIXavR9ZulfHvLZEAuuqZl73/36fmX5XEitWQgUptEY7W0RfDVGouagSwDzUVcfJls+eqonLsWdS1sK22I4+NOVP5mhdArshagqzXyetdCVcCz0+yZP1mNP5V/9u3e/WGxZqCka+nhP9sgZsaMJS8eZ5VWXafV9q4tuNIVX0eK31NpNEI6ME68nqhoDfg6SkLVFV9HSaDJQISvoyTQRy0Buo6PMCuyUvDVPP9di7PTCVtXfDUNuuoDX42DrhrBV9Ogq07w1TDoqhV0NYvPuop+DAE0ICyBr0bxWNfSQMTKpR1BOmCUhaFbW1slXU/2RGst8d92GuVEq6unQqCTJNwtNpbJWlmtjG/V0DWxSpDtXUvgq0kKthZ8jb8x3Yn//Ur8t5OqNn385farv/sS3f1y0XSweVwgHbrWDOmmUNoZ+GqQ1NMSqa63z78k/QEW/VqSBtr/eBTd/qqg67K9q2g4+2jRc+Zn3+7ljWKTnrTJ2nV7HloSTqFxS01pZ+CrORp1vfvm9O4f/vb700XHQBFdn/37XvRfnyrRNe3sKrq5ZH1eRQ+CjVzXZU/abI+1hDRGViPoaoxiLrDMBqIo6S34dZzBxv+laWos5u2zH7++//2Pz5a5a7wx6+ya9vrK+2rFH+TLLgdZX9hsj7WEXpGVgq+maMxdo+nedC+63olz2OSDPOnO8uw///Wnf1qmAcnGrLOr8HczD6TiSW3Z7SvrSZvtsZah6IqvZmisGYiut3+I7fv6h6yn1TRNTH/4w85S12Rj1tk1KZJ0IixH12VP2myPtacTcAPCIvhqiOZ617tfJsMG/TyLkaIWNF653jwq6JpUjaadXYWIWZ/XNHcVn/3TR4WetNkea08n3ObZZfDVDM26prX0Ynr2zM+nO8uxMQob846vJ4uagftDUTMgYuPff5P3pE00VqsZCKrzSxV8NUKzrk4YjK48bhnBY11DTgYifDWCz7qG+6glIB0wgNe62i2tG3zVD7qaA1+146uuyfiugb6EXYCvA2dQ0ZXHLe34Gl2j0CuyUvBVL+hqFNIBvXir63Kwd/kuMP7piq968VbXUDu/VMFXnXisq+3ShsBXjfisa4gdt2tAV314rOv94Y6YkkYhJfBTV3zVx8LQ+DOrout1+piTz5FhvNO2oJq7nuy0NpFtKO0RpAPaKNha8FV8R1QgxQFuoavxTtuCqq7T7bArslLwVReppyVSXVPpbp8vJ8wy3WlbUBLuJHG16a+irbRP4KsmGnVdhMSFrqY7bQtKwonYftLaG7GptFfgqx6KucAyG4gqs8UmC9OdtgUDrMhKQVctNOaui57WC11Nd9oWDFbXKLnArk8ieBprBtLctTQ3seFO24JCA8JgZtyW4wpfNdBc75qEz+tCdDXdaVsw8OiKrz1Z85pAZKiPTrNEddt8p20BusI61ujqgpWuhXsK9VjoOnh81vXk8U+v91TG0PZZV5JXHXisa9Jda28Ib7VS8LU/6GoVfO2Hx7pGU5EMBDuKSz342gufdU3ahAU7iksD+DoghluRtQBfh8MAZn5pBV8Hw/C6FtaAr0Oh8qi18oZg/n6ye5mszd5MJgeLRU1pj8HXgdAyUdHD54Po4pVYm384jmbfHWeLmtJeg6/DoEW4+cfzaPb2PF67EdKeHWQLudIega6DoOVRa/buMomrKdlaungSE46u+DoIWh61bnYLuj583i8sqqU9h3RgCLQ8ahWj6/z9fmGxWtpz8HUAtDxqLXPXaPbmoLBYLe09+Bo+LcKJD/60ZqDO1rB0xdfwaRMurXeNA+zFRHCQLSRLewa+hs6AJiqSAF8DZ0DTwMmAr2EztMHe28DXoBmbrvgaNCNLBiJ8DZpxPWol4Gu4jKA3wQr4Gixj1BVfg2VlfFeVUTFC1RVfQ6U6enak5GuouuJroIyuIisDX4NkrLria5CMr941B18DZPijuDSCr+ExyoqsDHwNjjHriq/BMcKXsAXwNTDG+6iVgK5hMdqKrAx8DQp0xdeAGHkygK9hMe5HLQG+BsSoK7JS8DUcxp67CvA1GNA1wtdwWAo3Xcy4PYL2rhXwNRBGMTdBO/gaBjxqpTAhZxC0DJipUDpw8DUEVoW7+8VRj9LBwnzyIVAj3PXqdEUKpUMFXUOgTtcRJwPo6jc1wp2MMrrmviKsz9Q8am2OMndNK7Pw1W+oyKqAsD5TJ9xfx5i7LiAj8JgV4eKMYJSPWgXw1VsqwomGAwpvYoepK8J6y8qjlsL4g8PVFV89pdQia/MoHYSwQ+nBgbA+shAua46Frjn46iFL4a6TtBVdlyCsdxSFuz8kdy1BnZZvVIS7pmagBL76xYpwcYgde71rCYT1iTrh/gddC+CrR9BmoB2E9QZ0lYBHLl9AVynw1Q/QVRKE9QF0lQVfPQBd5UFY56CrAvjqGnRVAmHdgq5qUKflFHRVBV8dgq7qXGVdvF2fxwhB1w4wgoYr0LUT+OoGdO0EuroBXTtxdUVC4AJ07cbVFcY6AF07kmmKsFZB195grD3QVQMkBbZAVz1grBXQVRsYa5424ebvJ7uXxbWHz5MXx7KlxwbGGqZFuIfPB9HFq+La2UF0kwmMrjVgrElahJt/PI9mb8+Xa2IhXXqkYKwxWoSbvbuM5h+Ol2uzd3/KkoEnMejaAMKaoUU48bmf6pqtzd4cJOZKlR41GGsA9eiab5AoPXIKSQHi6kE5d/0tuipA0wK9tNYM7C9qBvbzmgGSARXwVSNy9a4iwGb1rvHi5aJyAF2lQFdd8FbLAmQEukBXG1zlvRExth/oaoWFpSjbC3S1DnlBd9DVCRjbDXR1Bsqqg64uwVhF0NU1KKuAfl23trZ6HVMf/pxJCzx8yaJd160tXyzx50xkKBmLug3o1nVryxdL/DkTaXJlCbVNDFXXrS1fzkSNLu9rw/stOzM8XbeqODyXbijqGuYv2Q0zuaubq1dxNFhh1SJsmL9jR4zUDFi/ePXBtGCt5fPpSalFTIuygf5JdsRMvavFqyfxqR/e/ay2iGlQNvi0RxlTupq5dNXgKXufgr6b9couf/V0MQ5jDb3VMnPhVrNS+R8T9s0sG1v53Rdrw1fW1EtYE1et50df6PcyU3b9bz9wY421GTBwzXrnaDpvpQMntraUnr7snJRdzDVx0X/BdNwGXTfSthDLP1UpZYdqrMEWWdovl55boOUoVnVY/VApK9vg7hCVNdmAUPOl0nb1ex9oq462Eoo/oPKjVvdZKNte06Xyo/3GaHtXrRdK62XvfBtrTW21V/GnZbu3/yHIvP8alLKGddV3lXRfcfWbWFKxQUnttJ+WRCpbOlbQ6prtTaDv0pi4yPLC1ujTVtSKqgLJFgb5MRWO7CGGO7/oujSGLrGEFqr2rDmGod2lWxgo/yX4h+m+WnoujbkLvO7u6bu7igdR3F2yhcHy0OjaiI5rY/b65vdvq/xRr/XGKh6ox89tURZdW9ASm/oeovUHLG9j+J+Ya5++wv7NLHTc7nt1bFzebk85PtOobNC/nRVde10fS5d3QKbmKHRJCAUbw2L0faruXljt5wxL1pSBKWtlFJceGtgzaJC2Jki1MAgDO4MOdRbBpkFDtTVBpoVBAFgaI6ujCoM2yDqS7798xtaQbp3Ew1btoKscHczDVv2gqyTK7mGrCYK21aquavZhqxlCttXmcMRq/mErrGJz9GwFAwdbBwq9sDrYu7SD2Aq12J2bQNJCZIV6LE+lISUitkIDtmd+kTARW6EJ6xMVtbqIrdCIA121DiABo8L+NHDrfcRWWIODWQvXGYmtsA4Xk2w2O4mtsBYnc8I2WYmtsB43UxjXa4mt0IKjGbfrxMRWaMOZritqYiu04kjXVTmxFdpxpWtVT2wFCZzpWhYUW0EGd7oWFcVWkMKhrktJsRXkcKlrXp2FrSCJU10l5jYBKOCFrj2PAqMBXSEg0BUCAl0hINzqOuAxgMEEjnWlEgtUcK0rgALoCgGBrhAQ6AoBga4QEG3Czd9Pdi+z9dnb88JCpjSAVlqEe/h8EF28StdvJi/PlwuZ0gB6aRFu/vE8j6ZnL/4sVrKFVGkAvbQIN3t3Gc0/HGdflJKBJzHoClZpEe5mt1FXidIAelkj3Nlk8mpNdG0pDaAf+dwVXcE5rTUD+4uaAXQF18jVu6aGois4hrdaEBDoCgGBrhAQ6AoBga4QEOgKAYGuEBDoCgGBrhAQ6AoBga4QED11reNJ7dYm/Nl71KeiSSfTGDjPJ4Huzan4D7raOXi4p+IV6Grn4OGeileEkrQAROgKQYGuEBDoCgGBrhAQ+nUt9Dxs3/fNZHIgvffNpDA8lwRigC9pLiYqR3/4PHlxrHJold8zvioKv6fS3snNKQ7TFxjadb1RuHhiwI3Zd7K3XVzqRSdyGS4UFInOFPZN9r5RuuUKe4urciG9+/z9gfzeyc0pDtMXGrp1LY341saNuGhKniiF7l//Rv7QD99LB8soHS1EicVIOBIkI+dI/4DSODstpDenNNRJYLhNBiK1GxmpRIWH7/+ikAzEH5AKn9ezd39SSAYipfNWjK4quqY3R62EX7jWVQwTI3/oNwqOXOyr5K4iJ5GPsLM3B8ldl0XNDqXcMkkGpC+LuDmlYfoCw7Gu8/cKtkYq9z22SelRSyCdl6gGKKU8V/zl3Cg8Pb2Z/LP83xnRtYJazYCiUPJGpY/jan8M0gef/1btjp+pnId69FPIdMldKyhcCTVblW+jSnQVB3/4o/SZnyklA2rPcWrRNcl0pTNjcXNKw/QFhlNdFSsk492Vnm9U610VDh6nlwpVo4ofvTdKpxLvLZ9qUO8KYA10hYBAVwgIdIWAQFcICHSFgEBXCAh0hYAYq673hztrvpcMbLIdr95+dbTY/L//YeG8YC3o2vS9+8PHX4pbi+aCI9C18Xt3r/eKW9HVA0av6+3T+HN/R8i5sfnp2Wnxe9PtxNFkjz3x/06+9+1Xn+KVvTRv2I7S5aNTV7/MeBi7rkkInT46vXu9E68/Kul6/fhLrGsSVW+f7ollvvft0zhRiJf3h9vJNrGMpuXkAQwwdl3/TygWm3gtTJ1WdI29jHVNQ24SaPO9Y3vTZZYgJKUryQMYYOy6xqrFH++bR0lovH1WE12jk2IlQbp3GnEzyWOm6SCpzekw6GHsut693jwS4tXperKdORrntUmgXey9oit5gB3Gruu1EO16MxXvupQMiA/3/NM+Xher+d65rotkYJNaAyuMXlcRLp9uHq0+aiX1rnkEjZfC3nzvXFfxiJX+i/fFWfOMV9cs24wz081/i00UFVl/yHVdZKJJSE3S1Tg3iFPYbO9c11JFFraaZ6y61nJNCuo56JoiPsmT2lPwGXTNmGaNWsBn0BUCAl0hINAVAgJdISDQFQICXSEg0BUC4v8BPAkK1LamYcUAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">summary</span>(mwrm)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Call: </span>
<span class="co">#&gt; WRM(formula = musculus ~ pollution + exposure, family = &quot;poisson&quot;, </span>
<span class="co">#&gt;     data = musdata, coord = coords, level = 1, plot = TRUE)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Pearson Residuals: </span>
<span class="co">#&gt;       Min.    1st Qu.     Median       Mean    3rd Qu.       Max. </span>
<span class="co">#&gt; -1.6135878 -0.3057118  0.0047507 -0.0003873  0.3038946  3.0620363 </span>
<span class="co">#&gt; --- </span>
<span class="co">#&gt;  Coefficients: </span>
<span class="co">#&gt;             Estimate Std.Err z value Pr(&gt;|z|)   </span>
<span class="co">#&gt; (Intercept)  -1.9360  1.9177 -1.0095 0.312717   </span>
<span class="co">#&gt; pollution     3.1841  1.2251  2.5991 0.009348 **</span>
<span class="co">#&gt; exposure     -1.2286  1.5063 -0.8156 0.414723   </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; --- </span>
<span class="co">#&gt;  Number of observations n:  400 ,  n.eff:  300 ,  AIC:  1110.845 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Number of iterations:  7 </span>
<span class="co">#&gt; --- </span>
<span class="co">#&gt; Autocorrelation of glm.residuals </span>
<span class="co">#&gt;  [1]  0.685338504  0.509680590  0.363021118  0.247398654  0.144726020</span>
<span class="co">#&gt;  [6]  0.084220961  0.050228656  0.022369044 -0.001985639 -0.027296083</span>
<span class="co">#&gt; Autocorrelation of wavelet.residuals </span>
<span class="co">#&gt;  [1]  0.024855393 -0.086311686  0.007820356  0.024501828 -0.016578686</span>
<span class="co">#&gt;  [6]  0.002798656 -0.002977017 -0.004611334  0.018150352 -0.008727321</span>

predictions &lt;-<span class="st"> </span><span class="kw">predict</span>(mwrm, <span class="dt">newdata =</span> musdata)</code></pre></div>
<p><code>WRM</code> has many of the same features as <code>GEE</code>. Setting <code>plot = TRUE</code> allows you to visually examine the autocorrelation of residuals from a GLM of the same error family as your WRM. <code>customize_plot</code> works the same as in <code>GEE</code> - simply pass additional arguments to <code>ggplot</code> to modify the figure to meet your needs. Methods for <code>predict</code> and <code>summary</code> allow you to examine outputs from the model using the same code as you might use for a GLM. However, note that this reports an AIC score, rather than a QIC score as in the GEE.</p>
<div id="other-features-specific-to-wrms" class="section level4">
<h4>Other features specific to WRMs</h4>
<p><code>WRM</code> has a number of other model-specific functions that you may find useful in diagnosing model fit and understanding your results. For example, you might want to plot the variance and/or covariance of each of your variables as a function of <code>level</code>. The <code>covar.plot</code> function allows you to visually examine the wavelet relationships from your model. You can select whether to plot the variance or covariance using <code>plot</code> argument which accepts <code>&quot;var&quot;</code> or <code>&quot;covar&quot;</code> as inputs. Note that we are going to switch to the <code>carlinadata</code> data set now.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
coords &lt;-<span class="st"> </span>carlinadata[ ,<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]

<span class="kw">covar.plot</span>(carlina.horrida <span class="op">~</span><span class="st"> </span>aridity <span class="op">+</span><span class="st"> </span>land.use <span class="op">-</span><span class="st"> </span><span class="dv">1</span>,
           <span class="dt">data =</span> carlinadata, <span class="dt">coord =</span> coords, <span class="dt">wavelet =</span> <span class="st">&quot;d4&quot;</span>,
           <span class="dt">wtrafo =</span> <span class="st">'modwt'</span>, <span class="dt">plot =</span> <span class="st">'covar'</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>#&gt; $result
#&gt;                            [,1]   [,2]   [,3]   [,4]   [,5]
#&gt; carlina.horrida-aridity  0.0368 0.0450 0.0623 0.0780 0.0466
#&gt; carlina.horrida-land.use 0.4782 0.1191 0.0332 0.0126 0.0055

covar.plot(carlina.horrida ~ aridity + land.use - 1,
           data = carlinadata, coord = coords, wavelet = &quot;d4&quot;,
           wtrafo = 'modwt', plot = 'var')</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>#&gt; $result
#&gt;                   [,1]   [,2]   [,3]   [,4]   [,5]
#&gt; carlina.horrida 0.7235 0.1792 0.0628 0.0242 0.0093
#&gt; aridity         0.0691 0.1025 0.2028 0.3588 0.2657
#&gt; land.use        0.7556 0.1851 0.0420 0.0119 0.0044</code></pre>
<p>You may also want to view the smooth components of your wavelets at different <code>scale</code>s. For this, we offer the <code>upscale</code> function. <code>upscale</code> allows you to visually examine your data at a number of different levels of <code>scale</code> which controls the resolution of the grid cells in your data set.<a href="#fn8" class="footnoteRef" id="fnref8"><sup>8</sup></a> It also offers the option to adjust padding settings so you can see how that influences your smooth components. The default padding level is the mean value of your input vector, but it can be easily switched using the <code>pad</code> argument, which works the same way as in the other <code>WRM</code> functions. Finally, you can optionally produce gray scale or colorized maps using the <code>color.maps</code> argument. A quick example below using <code>carlinadata</code> data set.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">upscale</span>(carlinadata<span class="op">$</span>land.use, <span class="dt">coord =</span> coords,
        <span class="dt">pad =</span> <span class="kw">mean</span>(carlinadata<span class="op">$</span>land.use), <span class="dt">color.maps =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="multi-model-inference-with-gees-and-wrms" class="section level2">
<h2>Multi-model inference with GEEs and WRMs</h2>
<p><code>spind</code> provides a couple of frameworks for conducting multi-model inference analyses and some helper functions to assist you when examining the results. The first that we’ll examine here is the <code>step.spind</code> function, which implements step-wise model selection. The process is loosely based on <code>MASS::stepAIC</code> and <code>stats::step</code>, but is specific to classes <code>GEE</code> and <code>WRM</code>. For GEEs, <code>step.spind</code> uses models with the lowest QIC scores to determine what the next step will be. For WRMs, you have the option of using AIC or AICc (AIC corrected for small sample sizes) using the logical <code>AICc</code> argument.</p>
<p>Currently, the function only supports backwards model selection. In other words, you have to start with all of the variables in your model formula and remove them in a stepwise fashion. We hope to add forward model selection methods shortly. Additionally, <code>step.spind</code> is written to always respect the hierarchy of variables in the model and currently the user cannot directly override this. For example, <code>step.spind</code> would not remove <code>race</code> while retaining <code>I(race^2)</code>. We may change that in the future, but it will remain like this at least until the next major release. Currently, it recognizes polynomial variables by matching variable names located inside of <code>I(var^some_power)</code> and interaction terms by searching for <code>var1:var2</code> in the model terms. If you want to use a higher order polynomial variable and are not worried about the variable hierarchy, you can create a separate variable (i.e. <code>race_2</code>) and use that in the model.</p>
<p>We’ll go through an example of <code>step.spind</code> using a GEE on the <code>birthwt</code> data set in the <code>MASS</code> package below. The data in <code>birthwt</code> aren’t at all related to SDMs and are not spatially structured, but we hope that in using this data set, we will demonstrate how this function can work with many types of data sets.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># For demonstration only. We are artificially imposing a grid structure</span>
<span class="co"># on data that is not actually spatial data</span>

<span class="kw">library</span>(MASS)
<span class="kw">data</span>(birthwt)


x &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">14</span>, <span class="dv">14</span>)
y &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">gl</span>(<span class="dv">14</span>, <span class="dv">14</span>))
coords &lt;-<span class="st"> </span><span class="kw">cbind</span>(x[<span class="op">-</span>(<span class="dv">190</span><span class="op">:</span><span class="dv">196</span>)], y[<span class="op">-</span>(<span class="dv">190</span><span class="op">:</span><span class="dv">196</span>)])

formula &lt;-<span class="st"> </span><span class="kw">formula</span>(low <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>lwt <span class="op">+</span><span class="st"> </span>race <span class="op">+</span><span class="st"> </span>smoke <span class="op">+</span><span class="st"> </span>ftv <span class="op">+</span><span class="st">  </span>bwt <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(race<span class="op">^</span><span class="dv">2</span>))

mgee &lt;-<span class="st"> </span><span class="kw">GEE</span>(formula, <span class="dt">family =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="dt">data =</span> birthwt,
            <span class="dt">coord =</span> coords, <span class="dt">corstr =</span> <span class="st">&quot;fixed&quot;</span>,<span class="dt">scale.fix =</span> <span class="ot">TRUE</span>)

mwrm &lt;-<span class="st"> </span><span class="kw">WRM</span>(formula, <span class="dt">family =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="dt">data =</span> birthwt,
          <span class="dt">coord =</span> coords, <span class="dt">level =</span> <span class="dv">1</span>)

ssgee &lt;-<span class="st"> </span><span class="kw">step.spind</span>(mgee, birthwt)
<span class="co">#&gt; Iteration:  1 </span>
<span class="co">#&gt;  Single term deletions</span>
<span class="co">#&gt;  Deleted Term:  age </span>
<span class="co">#&gt;  -------------------- </span>
<span class="co">#&gt;   Deleted.Vars  Quasi.Lik      QIC</span>
<span class="co">#&gt; 1       &lt;none&gt;  -52.68206 112.4177</span>
<span class="co">#&gt; 2          age  -52.67027 111.9314</span>
<span class="co">#&gt; 3          lwt  -52.74725 112.3100</span>
<span class="co">#&gt; 4         race  -52.68782 112.1267</span>
<span class="co">#&gt; 5        smoke  -52.68652 112.1349</span>
<span class="co">#&gt; 6          ftv  -52.70359 112.1632</span>
<span class="co">#&gt; 7          bwt -121.62394 299.1973</span>
<span class="co">#&gt; 8    I(race^2)  -52.69176 112.1329</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Iteration:  2 </span>
<span class="co">#&gt;  Single term deletions</span>
<span class="co">#&gt;  Deleted Term:  race </span>
<span class="co">#&gt;  -------------------- </span>
<span class="co">#&gt;   Deleted.Vars  Quasi.Lik      QIC</span>
<span class="co">#&gt; 1       &lt;none&gt;  -52.67027 111.9314</span>
<span class="co">#&gt; 2          lwt  -52.72965 111.8146</span>
<span class="co">#&gt; 3         race  -52.67038 111.6474</span>
<span class="co">#&gt; 4        smoke  -52.67100 111.6566</span>
<span class="co">#&gt; 5          ftv  -52.72503 111.7364</span>
<span class="co">#&gt; 6          bwt -121.56174 299.0924</span>
<span class="co">#&gt; 7    I(race^2)  -52.67607 111.6567</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; -----</span>
<span class="co">#&gt; Model hierarchy violated by last removal</span>
<span class="co">#&gt;  New Deleted Term:  smoke </span>
<span class="co">#&gt; Previously deleted term added back into model</span>
<span class="co">#&gt; -----</span>
<span class="co">#&gt; Iteration:  3 </span>
<span class="co">#&gt;  Single term deletions</span>
<span class="co">#&gt;  Deleted Term:  race </span>
<span class="co">#&gt;  -------------------- </span>
<span class="co">#&gt;   Deleted.Vars  Quasi.Lik      QIC</span>
<span class="co">#&gt; 1       &lt;none&gt;  -52.67100 111.6566</span>
<span class="co">#&gt; 2          lwt  -52.72809 111.5311</span>
<span class="co">#&gt; 3         race  -52.67366 111.3802</span>
<span class="co">#&gt; 4          ftv  -52.72790 111.4711</span>
<span class="co">#&gt; 5          bwt -123.16568 300.0954</span>
<span class="co">#&gt; 6    I(race^2)  -52.67890 111.3877</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; -----</span>
<span class="co">#&gt; Model hierarchy violated by last removal</span>
<span class="co">#&gt;  New Deleted Term:  I(race^2) </span>
<span class="co">#&gt; Previously deleted term added back into model</span>
<span class="co">#&gt; -----</span>
<span class="co">#&gt; Iteration:  4 </span>
<span class="co">#&gt;  Single term deletions</span>
<span class="co">#&gt;  Deleted Term:  ftv </span>
<span class="co">#&gt;  -------------------- </span>
<span class="co">#&gt;   Deleted.Vars  Quasi.Lik      QIC</span>
<span class="co">#&gt; 1       &lt;none&gt;  -52.67890 111.3877</span>
<span class="co">#&gt; 2          lwt  -52.72805 111.2494</span>
<span class="co">#&gt; 3         race  -52.76311 111.3122</span>
<span class="co">#&gt; 4          ftv  -52.73630 111.2088</span>
<span class="co">#&gt; 5          bwt -123.33017 298.6147</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Iteration:  5 </span>
<span class="co">#&gt;  Single term deletions</span>
<span class="co">#&gt;  Deleted Term:  lwt </span>
<span class="co">#&gt;  -------------------- </span>
<span class="co">#&gt;   Deleted.Vars  Quasi.Lik      QIC</span>
<span class="co">#&gt; 1       &lt;none&gt;  -52.73630 111.2088</span>
<span class="co">#&gt; 2          lwt  -52.78793 111.0717</span>
<span class="co">#&gt; 3         race  -52.82335 111.1415</span>
<span class="co">#&gt; 4          bwt -123.35038 298.6351</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Iteration:  6 </span>
<span class="co">#&gt;  Single term deletions</span>
<span class="co">#&gt;  Deleted Term:  race </span>
<span class="co">#&gt;  -------------------- </span>
<span class="co">#&gt;   Deleted.Vars  Quasi.Lik      QIC</span>
<span class="co">#&gt; 1       &lt;none&gt;  -52.78793 111.0717</span>
<span class="co">#&gt; 2         race  -52.86072 110.9656</span>
<span class="co">#&gt; 3          bwt -123.12477 295.8817</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Iteration:  7 </span>
<span class="co">#&gt;  Single term deletions</span>
<span class="co">#&gt;  Deleted Term:  &lt;none&gt; </span>
<span class="co">#&gt;  -------------------- </span>
<span class="co">#&gt;   Deleted.Vars  Quasi.Lik      QIC</span>
<span class="co">#&gt; 1       &lt;none&gt;  -52.86072 110.9656</span>
<span class="co">#&gt; 2          bwt -123.98743 296.2879</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ---------------</span>
<span class="co">#&gt; Best model found:</span>
<span class="co">#&gt; low ~ bwt</span>
sswrm &lt;-<span class="st"> </span><span class="kw">step.spind</span>(mwrm, birthwt, <span class="dt">AICc =</span> <span class="ot">TRUE</span>)
<span class="co">#&gt; Iteration:  1 </span>
<span class="co">#&gt;  Single term deletions</span>
<span class="co">#&gt;  Deleted Term:  race </span>
<span class="co">#&gt;  -------------------- </span>
<span class="co">#&gt;   Deleted.Vars    LogLik       AIC      AICc</span>
<span class="co">#&gt; 1       &lt;none&gt; -36.27411  90.54822  91.55381</span>
<span class="co">#&gt; 2          age -36.27965  88.55930  89.35930</span>
<span class="co">#&gt; 3          lwt -36.30071  88.60143  89.40143</span>
<span class="co">#&gt; 4         race -36.03376  88.06752  88.86752</span>
<span class="co">#&gt; 5        smoke -36.13543  88.27087  89.07087</span>
<span class="co">#&gt; 6          ftv -36.25766  88.51532  89.31532</span>
<span class="co">#&gt; 7          bwt -88.97789 193.95579 194.75579</span>
<span class="co">#&gt; 8    I(race^2) -36.03879  88.07758  88.87758</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; -----</span>
<span class="co">#&gt; Model hierarchy violated by last removal</span>
<span class="co">#&gt;  New Deleted Term:  I(race^2) </span>
<span class="co">#&gt; Previously deleted term added back into model</span>
<span class="co">#&gt; -----</span>
<span class="co">#&gt; Iteration:  2 </span>
<span class="co">#&gt;  Single term deletions</span>
<span class="co">#&gt;  Deleted Term:  smoke </span>
<span class="co">#&gt;  -------------------- </span>
<span class="co">#&gt;   Deleted.Vars    LogLik       AIC      AICc</span>
<span class="co">#&gt; 1       &lt;none&gt; -36.03879  88.07758  88.87758</span>
<span class="co">#&gt; 2          age -36.04158  86.08317  86.70195</span>
<span class="co">#&gt; 3          lwt -36.09072  86.18144  86.80022</span>
<span class="co">#&gt; 4         race -36.11776  86.23552  86.85430</span>
<span class="co">#&gt; 5        smoke -35.90087  85.80174  86.42052</span>
<span class="co">#&gt; 6          ftv -36.02003  86.04007  86.65885</span>
<span class="co">#&gt; 7          bwt -88.71971 191.43941 192.05820</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Iteration:  3 </span>
<span class="co">#&gt;  Single term deletions</span>
<span class="co">#&gt;  Deleted Term:  ftv </span>
<span class="co">#&gt;  -------------------- </span>
<span class="co">#&gt;   Deleted.Vars    LogLik       AIC      AICc</span>
<span class="co">#&gt; 1       &lt;none&gt; -35.90087  85.80174  86.42052</span>
<span class="co">#&gt; 2          age -35.90797  83.81593  84.27747</span>
<span class="co">#&gt; 3          lwt -35.95683  83.91366  84.37520</span>
<span class="co">#&gt; 4         race -35.97398  83.94797  84.40950</span>
<span class="co">#&gt; 5          ftv -35.88997  83.77995  84.24149</span>
<span class="co">#&gt; 6          bwt -90.79731 193.59462 194.05616</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Iteration:  4 </span>
<span class="co">#&gt;  Single term deletions</span>
<span class="co">#&gt;  Deleted Term:  age </span>
<span class="co">#&gt;  -------------------- </span>
<span class="co">#&gt;   Deleted.Vars    LogLik       AIC      AICc</span>
<span class="co">#&gt; 1       &lt;none&gt; -35.88997  83.77995  84.24149</span>
<span class="co">#&gt; 2          age -35.89084  81.78169  82.10956</span>
<span class="co">#&gt; 3          lwt -35.94335  81.88670  82.21457</span>
<span class="co">#&gt; 4         race -35.96301  81.92602  82.25389</span>
<span class="co">#&gt; 5          bwt -90.81649 191.63298 191.96085</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Iteration:  5 </span>
<span class="co">#&gt;  Single term deletions</span>
<span class="co">#&gt;  Deleted Term:  lwt </span>
<span class="co">#&gt;  -------------------- </span>
<span class="co">#&gt;   Deleted.Vars    LogLik       AIC      AICc</span>
<span class="co">#&gt; 1       &lt;none&gt; -35.89084  81.78169  82.10956</span>
<span class="co">#&gt; 2          lwt -35.94877  79.89754  80.11494</span>
<span class="co">#&gt; 3         race -35.95486  79.90972  80.12711</span>
<span class="co">#&gt; 4          bwt -91.14883 190.29766 190.51505</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Iteration:  6 </span>
<span class="co">#&gt;  Single term deletions</span>
<span class="co">#&gt;  Deleted Term:  race </span>
<span class="co">#&gt;  -------------------- </span>
<span class="co">#&gt;   Deleted.Vars    LogLik       AIC      AICc</span>
<span class="co">#&gt; 1       &lt;none&gt; -35.94877  79.89754  80.11494</span>
<span class="co">#&gt; 2         race -36.00167  78.00334  78.13307</span>
<span class="co">#&gt; 3          bwt -91.88479 189.76958 189.89931</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Iteration:  7 </span>
<span class="co">#&gt;  Single term deletions</span>
<span class="co">#&gt;  Deleted Term:  &lt;none&gt; </span>
<span class="co">#&gt;  -------------------- </span>
<span class="co">#&gt;   Deleted.Vars    LogLik       AIC      AICc</span>
<span class="co">#&gt; 1       &lt;none&gt; -36.00167  78.00334  78.13307</span>
<span class="co">#&gt; 2          bwt -92.26134 188.52268 188.58719</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ---------------</span>
<span class="co">#&gt; Best model found:</span>
<span class="co">#&gt; low ~ bwt</span>

best.mgee &lt;-<span class="st"> </span><span class="kw">GEE</span>(ssgee<span class="op">$</span>model, <span class="dt">family =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="dt">data =</span> birthwt,
                 <span class="dt">coord =</span> coords, <span class="dt">corstr =</span> <span class="st">&quot;fixed&quot;</span>,<span class="dt">scale.fix =</span> <span class="ot">TRUE</span>)

best.wrm &lt;-<span class="st"> </span><span class="kw">WRM</span>(sswrm<span class="op">$</span>model, <span class="dt">family =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="dt">data =</span> birthwt,
                <span class="dt">coord =</span> coords, <span class="dt">level =</span> <span class="dv">1</span>)

<span class="kw">summary</span>(best.mgee, <span class="dt">printAutoCorPars =</span> <span class="ot">FALSE</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Call: </span>
<span class="co">#&gt; GEE(formula = ssgee$model, family = &quot;gaussian&quot;, data = birthwt, </span>
<span class="co">#&gt;     coord = coords, corstr = &quot;fixed&quot;, scale.fix = TRUE)</span>
<span class="co">#&gt; --- </span>
<span class="co">#&gt;  Coefficients: </span>
<span class="co">#&gt;                Estimate     Std.Err t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept)  1.2492e+00  4.9121e-01  2.5430  0.01099 *  </span>
<span class="co">#&gt; bwt         -3.0919e-04  6.5913e-05 -4.6909 2.72e-06 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; --- </span>
<span class="co">#&gt;  QIC:  110.9656 </span>
<span class="co">#&gt; --- </span>
<span class="co">#&gt; Autocorrelation of GLM residuals </span>
<span class="co">#&gt;  [1]  0.837748633  0.724407532  0.602588671  0.500754270  0.387294592</span>
<span class="co">#&gt;  [6]  0.275433941  0.147728669  0.008716423 -0.130798183 -0.268641655</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Autocorrelation of GEE residuals </span>
<span class="co">#&gt;  [1]  0.43453709  0.35186795  0.27457621  0.21231229  0.10255028</span>
<span class="co">#&gt;  [6]  0.08028419  0.07174312  0.04070057  0.02919975 -0.06904364</span>
<span class="kw">summary</span>(best.wrm)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Call: </span>
<span class="co">#&gt; WRM(formula = sswrm$model, family = &quot;gaussian&quot;, data = birthwt, </span>
<span class="co">#&gt;     coord = coords, level = 1)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Pearson Residuals: </span>
<span class="co">#&gt;     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. </span>
<span class="co">#&gt; -0.32375 -0.03533 -0.01311  0.00000  0.03328  0.42378 </span>
<span class="co">#&gt; --- </span>
<span class="co">#&gt;  Coefficients: </span>
<span class="co">#&gt;                Estimate     Std.Err     t value  Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept)  1.2809e+00  2.3089e-09  5.5477e+08 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; bwt         -3.4305e-04  7.4898e-06 -4.5802e+01 &lt; 2.2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; --- </span>
<span class="co">#&gt;  Number of observations n:  189 ,  n.eff:  142 ,  AIC:  78.00334 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Number of iterations:  2 </span>
<span class="co">#&gt; --- </span>
<span class="co">#&gt; Autocorrelation of glm.residuals </span>
<span class="co">#&gt;  [1]  0.837748633  0.724407532  0.602588671  0.500754270  0.387294592</span>
<span class="co">#&gt;  [6]  0.275433941  0.147728669  0.008716423 -0.130798183 -0.268641655</span>
<span class="co">#&gt; Autocorrelation of wavelet.residuals </span>
<span class="co">#&gt;  [1] 0.427865614 0.201246818 0.139896894 0.103437367 0.046485859</span>
<span class="co">#&gt;  [6] 0.045779123 0.025277466 0.034175107 0.005430915 0.055360212</span></code></pre></div>
<p>Additionally, we offer multimodel inference tools for GEEs and WRMs which are loosely based on the <code>MuMIn</code> package. These are implemented in <code>mmiWMRR</code> and <code>mmiGEE</code>. They enable you to examine the effect that the grid resolution and variable selection have on the resulting regressions, and then select the appropriate model for subsequent analyses. Note that <code>mmiWMRR</code> has two more arguments than <code>mmiGEE</code> that must be specified.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Example for WRMs</span>
<span class="kw">data</span>(carlinadata)
coords &lt;-<span class="st"> </span>carlinadata[ ,<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]

wrm &lt;-<span class="st"> </span><span class="kw">WRM</span>(carlina.horrida <span class="op">~</span><span class="st"> </span>aridity <span class="op">+</span><span class="st"> </span>land.use, <span class="dt">family =</span> <span class="st">&quot;poisson&quot;</span>,
           <span class="dt">data =</span> carlinadata, <span class="dt">coord =</span> coords, <span class="dt">level =</span> <span class="dv">1</span>, <span class="dt">wavelet =</span> <span class="st">&quot;d4&quot;</span>)

ms1 &lt;-<span class="st"> </span><span class="kw">scaleWMRR</span>(carlina.horrida <span class="op">~</span><span class="st"> </span>aridity <span class="op">+</span><span class="st"> </span>land.use, <span class="dt">family =</span> <span class="st">&quot;poisson&quot;</span>,
                 <span class="dt">data =</span> carlinadata, <span class="dt">coord =</span> coords, <span class="dt">scale =</span> <span class="dv">1</span>,
                 <span class="dt">wavelet =</span> <span class="st">'d4'</span>, <span class="dt">trace =</span> <span class="ot">FALSE</span>)

mmi &lt;-<span class="st"> </span><span class="kw">mmiWMRR</span>(wrm, <span class="dt">data =</span> carlinadata, <span class="dt">scale =</span> <span class="dv">1</span>, <span class="dt">detail =</span> <span class="ot">TRUE</span>)

<span class="co"># Example for GEEs</span>
<span class="kw">library</span>(MASS)
<span class="kw">data</span>(birthwt)

<span class="co"># impose an artificial (not fully appropriate) grid structure</span>
x &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">14</span>, <span class="dv">14</span>)
y &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">gl</span>(<span class="dv">14</span>, <span class="dv">14</span>))
coords &lt;-<span class="st"> </span><span class="kw">cbind</span>(x[<span class="op">-</span>(<span class="dv">190</span><span class="op">:</span><span class="dv">196</span>)], y[<span class="op">-</span>(<span class="dv">190</span><span class="op">:</span><span class="dv">196</span>)])

formula &lt;-<span class="st"> </span><span class="kw">formula</span>(low <span class="op">~</span><span class="st"> </span>race <span class="op">+</span><span class="st"> </span>smoke <span class="op">+</span><span class="st">  </span>bwt)

mgee &lt;-<span class="st"> </span><span class="kw">GEE</span>(formula, <span class="dt">family =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="dt">data =</span> birthwt,
            <span class="dt">coord =</span> coords, <span class="dt">corstr =</span> <span class="st">&quot;fixed&quot;</span>, <span class="dt">scale.fix =</span> <span class="ot">TRUE</span>)

mmi &lt;-<span class="st"> </span><span class="kw">mmiGEE</span>(mgee, birthwt)</code></pre></div>
<p>Finally, we offer one further model selection procedure specific to WRMs. <code>rvi.plot</code> uses <code>mmiWMRR</code> and creates a plot of the relative importance of each explanatory variable as a function of the resolution of the grid (in other words, as a function of the <code>scale</code> argument in <code>mmiWMRR</code>). It will also print the resulting model selection tables to the console.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(carlinadata)
coords &lt;-<span class="st"> </span>carlinadata[ ,<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]

<span class="kw">rvi.plot</span>(carlina.horrida <span class="op">~</span><span class="st"> </span>aridity <span class="op">+</span><span class="st"> </span>land.use, <span class="dt">family =</span> <span class="st">&quot;poisson&quot;</span>,
         <span class="dt">data =</span> carlinadata, <span class="dt">coord =</span> coords, <span class="dt">maxlevel =</span> <span class="dv">4</span>, 
         <span class="dt">detail =</span> <span class="ot">TRUE</span>, <span class="dt">wavelet =</span> <span class="st">&quot;d4&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="goodness-of-fit-and-model-performance" class="section level2">
<h2>Goodness of fit and model performance</h2>
<p>You may also find that a model not implemented by this package works best for your data. We’ve implemented some spatially corrected accuracy measures that you can use to assess goodness of model fit. The first two of these are categorized according to whether or not their outputs are dependent on the chosen threshold and first appeared in <code>spind v1.0</code> <a href="#fn9" class="footnoteRef" id="fnref9"><sup>9</sup></a>. <code>th.dep</code> (threshold dependent) and <code>th.indep</code> (threshold independent) are designed to work on any number of model types, all you need is a set of actual values, predictions, and their associated coordinates. We’ll use the <code>hook</code> data set to see how these work.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(hook)

<span class="co"># Familiarize yourself with the data</span>
?hook
<span class="kw">head</span>(hook)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
df &lt;-<span class="st"> </span>hook[ ,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]
coords &lt;-<span class="st"> </span>hook[ ,<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>]

<span class="co"># Threshold dependent metrics</span>
th.dep.indices &lt;-<span class="st"> </span><span class="kw">th.dep</span>(<span class="dt">data =</span> df, <span class="dt">coord =</span> coords, <span class="dt">spatial =</span> <span class="ot">TRUE</span>)

<span class="co"># Confusion Matrix</span>
th.dep.indices<span class="op">$</span>cm
<span class="co">#&gt;      [,1] [,2] [,3] [,4]</span>
<span class="co">#&gt; [1,]    5    2    0    0</span>
<span class="co">#&gt; [2,]    3    1    1    3</span>
<span class="co">#&gt; [3,]    2    0    0    8</span>
<span class="co">#&gt; [4,]    2    3    0   70</span>

<span class="co"># Kappa statistic</span>
th.dep.indices<span class="op">$</span>kappa
<span class="co">#&gt; [1] 0.628529</span>

<span class="co"># Threshold independent metrics</span>
th.indep.indices &lt;-<span class="st"> </span><span class="kw">th.indep</span>(<span class="dt">data =</span> df, <span class="dt">coord =</span> coords, 
                             <span class="dt">spatial =</span> <span class="ot">TRUE</span>, <span class="dt">plot.ROC =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># AUC</span>
th.indep.indices<span class="op">$</span>AUC
<span class="co">#&gt; [1] 0.9424119</span>

<span class="co"># TSS</span>
th.indep.indices<span class="op">$</span>TSS
<span class="co">#&gt; [1] 0.7425474</span></code></pre></div>
<p>Finally, many analyses require a calculation of spatial autocorrelation. To that end, we include the function <code>acfft</code> (AutoCorrelation Fast Fourier Transform) to calculate spatial autocorrelation using Moran’s I statistic. While many other packages include functions to perform this analysis, ours provides improved efficiency by harnessing the power of fast Fourier transforms which reduce the time needed to compute the statistic. A quick example below using a GLM and the <code>musdata</code> data set.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
coords &lt;-<span class="st"> </span>musdata[ ,<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]
mglm &lt;-<span class="st"> </span><span class="kw">glm</span>(musculus <span class="op">~</span><span class="st"> </span>pollution <span class="op">+</span><span class="st"> </span>exposure, <span class="dt">family =</span> <span class="st">&quot;poisson&quot;</span>,
            <span class="dt">data =</span> musdata)

ac &lt;-<span class="st"> </span><span class="kw">acfft</span>(coords, <span class="kw">resid</span>(mglm, <span class="dt">type =</span> <span class="st">&quot;pearson&quot;</span>),
            <span class="dt">lim1 =</span> <span class="dv">0</span>, <span class="dt">lim2 =</span> <span class="dv">1</span>, <span class="dt">dmax =</span> <span class="dv">10</span>)
ac
<span class="co">#&gt;  [1]  0.685338504  0.509680590  0.363021118  0.247398654  0.144726020</span>
<span class="co">#&gt;  [6]  0.084220961  0.050228656  0.022369044 -0.001985639 -0.027296083</span></code></pre></div>
<p>Note that you can adjust the number of distance bins to examine in <code>acfft</code> using the <code>dmax</code> argument. The default is 10. Finally, you can adjust the size of the distance bins by adjusting the values of <code>lim1</code> and <code>lim2</code> to meet your needs.</p>
</div>
<div id="wrapping-up" class="section level2">
<h2>Wrapping up</h2>
<p>Hopefully, you are now ready to utilize GEEs and WRMs to conquer the world of spatial modeling. However, if this vignette has not served its purpose and you still have questions about how to use these tools, please let us know. Of course, no package is complete without bugs and we are always trying to improve our code. If you find any bugs that need squashing, have suggestions for additional functionality or improvements to existing functionality (or this vignette), please don’t hesitate to contact us<a href="#fn10" class="footnoteRef" id="fnref10"><sup>10</sup></a>.</p>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Carl G &amp; Kuehn I, 2007. Analyzing Spatial Autocorrelation in Species Distributions using Gaussian and Logit Models, Ecol. Model. 207, 159 - 170]<a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>Carey, V. J., 2006. Ported to R by Thomas Lumley (versions 3.13, 4.4, version 4.13)., B. R. gee: Generalized Estimation Equation solver. R package version 4.13-11.<a href="#fnref2">↩</a></p></li>
<li id="fn3"><p>Yan, J., 2004. geepack: Generalized Estimating Equation Package. R package version 0.2.10.<a href="#fnref3">↩</a></p></li>
<li id="fn4"><p>Hardin, J.W. &amp; Hilbe, J.M. (2003) Generalized Estimating Equations. Chapman and Hall, New York.<a href="#fnref4">↩</a></p></li>
<li id="fn5"><p>Barnett et al. Methods in Ecology &amp; Evolution 2010, 1, 15-24.<a href="#fnref5">↩</a></p></li>
<li id="fn6"><p>Carl, G., Kuehn, I. (2010): A wavelet-based extension of generalized linear models to remove the effect of spatial autocorrelation. Geographical Analysis 42 (3), 323 - 337<a href="#fnref6">↩</a></p></li>
<li id="fn7"><p>Whitcher, B. (2005) Waveslim: basic wavelet routines for one-, two- and three-dimensional signal processing. R package version 1.5.<a href="#fnref7">↩</a></p></li>
<li id="fn8"><p>Carl G, Doktor D, Schweiger O, Kuehn I (2016) Assessing relative variable importance across different spatial scales: a two-dimensional wavelet analysis. Journal of Biogeography 43: 2502-2512.<a href="#fnref8">↩</a></p></li>
<li id="fn9"><p>Carl G, Kuehn I (2017) Spind: a package for computing spatially corrected accuracy measures. Ecography 40: 675-682. doi: 10.1111/ecog.02593<a href="#fnref9">↩</a></p></li>
<li id="fn10"><p>Contact email - <a href="mailto:levisc8@gmail.com">levisc8@gmail.com</a> or visit the Github repo and create an issue at <a href="http://github.com/levisc8/spind/issues" class="uri">http://github.com/levisc8/spind/issues</a>.<a href="#fnref10">↩</a></p></li>
</ol>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
